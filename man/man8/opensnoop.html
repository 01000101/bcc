Content-type: text/html; charset=UTF-8

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of opensnoop</TITLE>
</HEAD><BODY>
<H1>opensnoop</H1>
Section: Maintenance Commands (8)<BR>Updated: 2020-02-20<BR><A HREF="#index">Index</A>
<A HREF="https://iovisor.github.io/bcc">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

opensnoop - Trace open() syscalls. Uses Linux eBPF/bcc.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>opensnoop.py [-h] [-T] [-U] [-x] [-p PID] [-t TID] [-u UID]</B>

<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-d&nbsp;DURATION]&nbsp;[-n&nbsp;NAME]&nbsp;[-e]&nbsp;[-f&nbsp;FLAG_FILTER]
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[--cgroupmap&nbsp;MAPPATH]
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

opensnoop traces the open() syscall, showing which processes are attempting
to open which files. This can be useful for determining the location of config
and log files, or for troubleshooting applications that are failing, specially
on startup.
<P>
This works by tracing the kernel sys_open() function using dynamic tracing, and
will need updating to match any changes to this function.
<P>
This makes use of a Linux 4.4 feature (bpf_perf_event_output());
for kernels older than 4.4, see the version under tools/old,
which uses an older mechanism.
<P>
Since this uses BPF, only the root user can use this tool.
<A NAME="lbAE">&nbsp;</A>
<H2>REQUIREMENTS</H2>

CONFIG_BPF and bcc.
<A NAME="lbAF">&nbsp;</A>
<H2>OPTIONS</H2>

<DL COMPACT>
<DT>-h<DD>
Print usage message.
<DT>-T<DD>
Include a timestamp column.
<DT>-U<DD>
Show UID.
<DT>-x<DD>
Only print failed opens.
<DT>-p PID<DD>
Trace this process ID only (filtered in-kernel).
<DT>-t TID<DD>
Trace this thread ID only (filtered in-kernel).
<DT>-u UID<DD>
Trace this UID only (filtered in-kernel).
<DT>-d DURATION<DD>
Total duration of trace in seconds.
<DT>-n name<DD>
Only print processes where its name partially matches 'name'
<DT>-e<DD>
Show extended fields.
<DT>-f FLAG<DD>
Filter on open() flags, e.g., O_WRONLY.
<DT>--cgroupmap MAPPATH<DD>
Trace cgroups in this BPF map only (filtered in-kernel).
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>EXAMPLES</H2>

<DL COMPACT>
<DT>Trace all open() syscalls:<DD>
#
<B>opensnoop</B>

<DT>Trace all open() syscalls, for 10 seconds only:<DD>
#
<B>opensnoop -d 10</B>

<DT>Trace all open() syscalls, and include timestamps:<DD>
#
<B>opensnoop -T</B>

<DT>Show UID:<DD>
#
<B>opensnoop -U</B>

<DT>Trace only open() syscalls that failed:<DD>
#
<B>opensnoop -x</B>

<DT>Trace PID 181 only:<DD>
#
<B>opensnoop -p 181</B>

<DT>Trace UID 1000 only:<DD>
#
<B>opensnoop -u 1000</B>

<DT>Trace all open() syscalls from processes where its name partially matches 'ed':<DD>
#
<B>opensnoop -n ed</B>

<DT>Show extended fields:<DD>
#
<B>opensnoop -e</B>

<DT>Only print calls for writing:<DD>
#
<B>opensnoop -f O_WRONLY -f O_RDWR</B>

<DT>Trace a set of cgroups only (see filtering_by_cgroups.md from bcc sources for more details):<DD>
#
<B>opensnoop --cgroupmap /sys/fs/bpf/test01</B>

</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>FIELDS</H2>

<DL COMPACT>
<DT>TIME(s)<DD>
Time of the call, in seconds.
<DT>UID<DD>
User ID
<DT>PID<DD>
Process ID
<DT>TID<DD>
Thread ID
<DT>COMM<DD>
Process name
<DT>FD<DD>
File descriptor (if success), or -1 (if failed)
<DT>ERR<DD>
Error number (see the system's errno.h)
<DT>FLAGS<DD>
Flags passed to <A HREF="https://iovisor.github.io/bcc?2+open">open</A>(2), in octal
<DT>PATH<DD>
Open path
</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>OVERHEAD</H2>

This traces the kernel open function and prints output for each event. As the
rate of this is generally expected to be low (&lt; 1000/s), the overhead is also
expected to be negligible. If you have an application that is calling a high
rate of open()s, then test and understand overhead before use.
<A NAME="lbAJ">&nbsp;</A>
<H2>SOURCE</H2>

This is from bcc.
<DL COMPACT>
<DT><DD>
<A HREF="https://github.com/iovisor/bcc">https://github.com/iovisor/bcc</A>
</DL>
<P>

Also look in the bcc distribution for a companion _examples.txt file containing
example usage, output, and commentary for this tool.
<A NAME="lbAK">&nbsp;</A>
<H2>OS</H2>

Linux
<A NAME="lbAL">&nbsp;</A>
<H2>STABILITY</H2>

Unstable - in development.
<A NAME="lbAM">&nbsp;</A>
<H2>AUTHOR</H2>

Brendan Gregg
<A NAME="lbAN">&nbsp;</A>
<H2>SEE ALSO</H2>

<A HREF="https://iovisor.github.io/bcc?8+execsnoop">execsnoop</A>(8), <A HREF="https://iovisor.github.io/bcc?1+funccount">funccount</A>(1)
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">REQUIREMENTS</A><DD>
<DT><A HREF="#lbAF">OPTIONS</A><DD>
<DT><A HREF="#lbAG">EXAMPLES</A><DD>
<DT><A HREF="#lbAH">FIELDS</A><DD>
<DT><A HREF="#lbAI">OVERHEAD</A><DD>
<DT><A HREF="#lbAJ">SOURCE</A><DD>
<DT><A HREF="#lbAK">OS</A><DD>
<DT><A HREF="#lbAL">STABILITY</A><DD>
<DT><A HREF="#lbAM">AUTHOR</A><DD>
<DT><A HREF="#lbAN">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="https://iovisor.github.io/bcc">man2html</A>,
using the manual pages.<BR>
Time: 17:11:49 GMT, February 25, 2020
</BODY>
</HTML>
