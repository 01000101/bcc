Content-type: text/html; charset=UTF-8

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of tcptracer</TITLE>
</HEAD><BODY>
<H1>tcptracer</H1>
Section: Maintenance Commands (8)<BR>Updated: 2020-02-20<BR><A HREF="#index">Index</A>
<A HREF="https://iovisor.github.io/bcc">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

tcptracer - Trace TCP established connections. Uses Linux eBPF/bcc.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>tcptracer [-h] [-v] [-p PID] [-N NETNS] [--cgroupmap MAPPATH]</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

This tool traces established TCP connections that open and close while tracing,
and prints a line of output per connect, accept and close events. This includes
the type of event, PID, IP addresses and ports.
<P>
This tool works by using kernel dynamic tracing, and will need to be updated if
the kernel implementation changes. Only established TCP connections are traced,
so it is expected that the overhead of this tool is rather low.
<P>
Since this uses BPF, only the root user can use this tool.
<A NAME="lbAE">&nbsp;</A>
<H2>REQUIREMENTS</H2>

CONFIG_BPF and bcc.
<A NAME="lbAF">&nbsp;</A>
<H2>OPTIONS</H2>

<DL COMPACT>
<DT>-h<DD>
Print usage message.
<DT>-v<DD>
Print full lines, with long event type names and network namespace numbers.
<DT>-p PID<DD>
Trace this process ID only (filtered in-kernel).
<DT>-N NETNS<DD>
Trace this network namespace only (filtered in-kernel).
<DT>--cgroupmap MAPPATH<DD>
Trace cgroups in this BPF map only (filtered in-kernel).
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>EXAMPLES</H2>

<DL COMPACT>
<DT>Trace all TCP established connections:<DD>
#
<B>tcptracer</B>

<DT>Trace all TCP established connections with verbose lines:<DD>
#
<B>tcptracer -v</B>

<DT>Trace PID 181 only:<DD>
#
<B>tcptracer -p 181</B>

<DT>Trace connections in network namespace 4026531969 only:<DD>
#
<B>tcptracer -N 4026531969</B>

<DT>Trace a set of cgroups only (see filtering_by_cgroups.md from bcc sources for more details):<DD>
#
<B>tcptracer --cgroupmap /sys/fs/bpf/test01</B>

</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>FIELDS</H2>

<DL COMPACT>
<DT>TYPE<DD>
Type of event. In non-verbose mode: C for connect, A for accept, X for close.
<DT>PID<DD>
Process ID
<DT>COMM<DD>
Process name
<DT>IP<DD>
IP address family (4 or 6)
<DT>SADDR<DD>
Source IP address.
<DT>DADDR<DD>
Destination IP address.
<DT>SPORT<DD>
Source port.
<DT>DPORT<DD>
Destination port.
<DT>NETNS<DD>
Network namespace where the event originated.
</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>OVERHEAD</H2>

This traces the kernel inet accept function, and the TCP connect, close,
and set state functions. However, it only prints information for connections
that are established, so it shouldn't have a huge overhead.
<P>
As always, test and understand this tools overhead for your types of workloads
before production use.
<A NAME="lbAJ">&nbsp;</A>
<H2>SOURCE</H2>

This is from bcc.
<DL COMPACT>
<DT><DD>
<A HREF="https://github.com/iovisor/bcc">https://github.com/iovisor/bcc</A>
</DL>
<P>

Also look in the bcc distribution for a companion _examples.txt file containing
example usage, output, and commentary for this tool.
<A NAME="lbAK">&nbsp;</A>
<H2>OS</H2>

Linux
<A NAME="lbAL">&nbsp;</A>
<H2>STABILITY</H2>

Unstable - in development.
<A NAME="lbAM">&nbsp;</A>
<H2>AUTHOR</H2>

Iago LÃ³pez Galeiras
<A NAME="lbAN">&nbsp;</A>
<H2>SEE ALSO</H2>

<A HREF="https://iovisor.github.io/bcc?8+tcpaccept">tcpaccept</A>(8), <A HREF="https://iovisor.github.io/bcc?8+tcpconnect">tcpconnect</A>(8), <A HREF="https://iovisor.github.io/bcc?8+tcptop">tcptop</A>(8), <A HREF="https://iovisor.github.io/bcc?8+tcplife">tcplife</A>(8)
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">REQUIREMENTS</A><DD>
<DT><A HREF="#lbAF">OPTIONS</A><DD>
<DT><A HREF="#lbAG">EXAMPLES</A><DD>
<DT><A HREF="#lbAH">FIELDS</A><DD>
<DT><A HREF="#lbAI">OVERHEAD</A><DD>
<DT><A HREF="#lbAJ">SOURCE</A><DD>
<DT><A HREF="#lbAK">OS</A><DD>
<DT><A HREF="#lbAL">STABILITY</A><DD>
<DT><A HREF="#lbAM">AUTHOR</A><DD>
<DT><A HREF="#lbAN">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="https://iovisor.github.io/bcc">man2html</A>,
using the manual pages.<BR>
Time: 17:11:49 GMT, February 25, 2020
</BODY>
</HTML>
